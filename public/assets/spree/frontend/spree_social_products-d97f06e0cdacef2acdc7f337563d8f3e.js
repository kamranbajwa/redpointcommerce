!function(t){t.extend(t.fn,{validate:function(e){if(!this.length)return void(e&&e.debug&&window.console&&console.warn("Nothing selected, can't validate, returning nothing."));var r=t.data(this[0],"validator");return r?r:(this.attr("novalidate","novalidate"),r=new t.validator(e,this[0]),t.data(this[0],"validator",r),r.settings.onsubmit&&(this.validateDelegate(":submit","click",function(e){r.settings.submitHandler&&(r.submitButton=e.target),t(e.target).hasClass("cancel")&&(r.cancelSubmit=!0),void 0!==t(e.target).attr("formnovalidate")&&(r.cancelSubmit=!0)}),this.submit(function(e){function n(){var n;return r.settings.submitHandler?(r.submitButton&&(n=t("<input type='hidden'/>").attr("name",r.submitButton.name).val(t(r.submitButton).val()).appendTo(r.currentForm)),r.settings.submitHandler.call(r,r.currentForm,e),r.submitButton&&n.remove(),!1):!0}return r.settings.debug&&e.preventDefault(),r.cancelSubmit?(r.cancelSubmit=!1,n()):r.form()?r.pendingRequest?(r.formSubmitted=!0,!1):n():(r.focusInvalid(),!1)})),r)},valid:function(){if(t(this[0]).is("form"))return this.validate().form();var e=!0,r=t(this[0].form).validate();return this.each(function(){e=e&&r.element(this)}),e},removeAttrs:function(e){var r={},n=this;return t.each(e.split(/\s/),function(t,e){r[e]=n.attr(e),n.removeAttr(e)}),r},rules:function(e,r){var n=this[0];if(e){var i=t.data(n.form,"validator").settings,a=i.rules,s=t.validator.staticRules(n);switch(e){case"add":t.extend(s,t.validator.normalizeRule(r)),delete s.messages,a[n.name]=s,r.messages&&(i.messages[n.name]=t.extend(i.messages[n.name],r.messages));break;case"remove":if(!r)return delete a[n.name],s;var o={};return t.each(r.split(/\s/),function(t,e){o[e]=s[e],delete s[e]}),o}}var u=t.validator.normalizeRules(t.extend({},t.validator.classRules(n),t.validator.attributeRules(n),t.validator.dataRules(n),t.validator.staticRules(n)),n);if(u.required){var l=u.required;delete u.required,u=t.extend({required:l},u)}return u}}),t.extend(t.expr[":"],{blank:function(e){return!t.trim(""+t(e).val())},filled:function(e){return!!t.trim(""+t(e).val())},unchecked:function(e){return!t(e).prop("checked")}}),t.validator=function(e,r){this.settings=t.extend(!0,{},t.validator.defaults,e),this.currentForm=r,this.init()},t.validator.format=function(e,r){return 1===arguments.length?function(){var r=t.makeArray(arguments);return r.unshift(e),t.validator.format.apply(this,r)}:(arguments.length>2&&r.constructor!==Array&&(r=t.makeArray(arguments).slice(1)),r.constructor!==Array&&(r=[r]),t.each(r,function(t,r){e=e.replace(new RegExp("\\{"+t+"\\}","g"),function(){return r})}),e)},t.extend(t.validator,{defaults:{messages:{},groups:{},rules:{},errorClass:"error",validClass:"valid",errorElement:"label",focusInvalid:!0,errorContainer:t([]),errorLabelContainer:t([]),onsubmit:!0,ignore:":hidden",ignoreTitle:!1,onfocusin:function(t){this.lastActive=t,this.settings.focusCleanup&&!this.blockFocusCleanup&&(this.settings.unhighlight&&this.settings.unhighlight.call(this,t,this.settings.errorClass,this.settings.validClass),this.addWrapper(this.errorsFor(t)).hide())},onfocusout:function(t){this.checkable(t)||!(t.name in this.submitted)&&this.optional(t)||this.element(t)},onkeyup:function(t,e){(9!==e.which||""!==this.elementValue(t))&&(t.name in this.submitted||t===this.lastElement)&&this.element(t)},onclick:function(t){t.name in this.submitted?this.element(t):t.parentNode.name in this.submitted&&this.element(t.parentNode)},highlight:function(e,r,n){"radio"===e.type?this.findByName(e.name).addClass(r).removeClass(n):t(e).addClass(r).removeClass(n)},unhighlight:function(e,r,n){"radio"===e.type?this.findByName(e.name).removeClass(r).addClass(n):t(e).removeClass(r).addClass(n)}},setDefaults:function(e){t.extend(t.validator.defaults,e)},messages:{required:"This field is required.",remote:"Please fix this field.",email:"Please enter a valid email address.",url:"Please enter a valid URL.",date:"Please enter a valid date.",dateISO:"Please enter a valid date (ISO).",number:"Please enter a valid number.",digits:"Please enter only digits.",creditcard:"Please enter a valid credit card number.",equalTo:"Please enter the same value again.",maxlength:t.validator.format("Please enter no more than {0} characters."),minlength:t.validator.format("Please enter at least {0} characters."),rangelength:t.validator.format("Please enter a value between {0} and {1} characters long."),range:t.validator.format("Please enter a value between {0} and {1}."),max:t.validator.format("Please enter a value less than or equal to {0}."),min:t.validator.format("Please enter a value greater than or equal to {0}.")},autoCreateRanges:!1,prototype:{init:function(){function e(e){var r=t.data(this[0].form,"validator"),n="on"+e.type.replace(/^validate/,"");r.settings[n]&&r.settings[n].call(r,this[0],e)}this.labelContainer=t(this.settings.errorLabelContainer),this.errorContext=this.labelContainer.length&&this.labelContainer||t(this.currentForm),this.containers=t(this.settings.errorContainer).add(this.settings.errorLabelContainer),this.submitted={},this.valueCache={},this.pendingRequest=0,this.pending={},this.invalid={},this.reset();var r=this.groups={};t.each(this.settings.groups,function(e,n){"string"==typeof n&&(n=n.split(/\s/)),t.each(n,function(t,n){r[n]=e})});var n=this.settings.rules;t.each(n,function(e,r){n[e]=t.validator.normalizeRule(r)}),t(this.currentForm).validateDelegate(":text, [type='password'], [type='file'], select, textarea, [type='number'], [type='search'] ,[type='tel'], [type='url'], [type='email'], [type='datetime'], [type='date'], [type='month'], [type='week'], [type='time'], [type='datetime-local'], [type='range'], [type='color'] ","focusin focusout keyup",e).validateDelegate("[type='radio'], [type='checkbox'], select, option","click",e),this.settings.invalidHandler&&t(this.currentForm).bind("invalid-form.validate",this.settings.invalidHandler)},form:function(){return this.checkForm(),t.extend(this.submitted,this.errorMap),this.invalid=t.extend({},this.errorMap),this.valid()||t(this.currentForm).triggerHandler("invalid-form",[this]),this.showErrors(),this.valid()},checkForm:function(){this.prepareForm();for(var t=0,e=this.currentElements=this.elements();e[t];t++)this.check(e[t]);return this.valid()},element:function(e){e=this.validationTargetFor(this.clean(e)),this.lastElement=e,this.prepareElement(e),this.currentElements=t(e);var r=this.check(e)!==!1;return r?delete this.invalid[e.name]:this.invalid[e.name]=!0,this.numberOfInvalids()||(this.toHide=this.toHide.add(this.containers)),this.showErrors(),r},showErrors:function(e){if(e){t.extend(this.errorMap,e),this.errorList=[];for(var r in e)this.errorList.push({message:e[r],element:this.findByName(r)[0]});this.successList=t.grep(this.successList,function(t){return!(t.name in e)})}this.settings.showErrors?this.settings.showErrors.call(this,this.errorMap,this.errorList):this.defaultShowErrors()},resetForm:function(){t.fn.resetForm&&t(this.currentForm).resetForm(),this.submitted={},this.lastElement=null,this.prepareForm(),this.hideErrors(),this.elements().removeClass(this.settings.errorClass).removeData("previousValue")},numberOfInvalids:function(){return this.objectLength(this.invalid)},objectLength:function(t){var e=0;for(var r in t)e++;return e},hideErrors:function(){this.addWrapper(this.toHide).hide()},valid:function(){return 0===this.size()},size:function(){return this.errorList.length},focusInvalid:function(){if(this.settings.focusInvalid)try{t(this.findLastActive()||this.errorList.length&&this.errorList[0].element||[]).filter(":visible").focus().trigger("focusin")}catch(e){}},findLastActive:function(){var e=this.lastActive;return e&&1===t.grep(this.errorList,function(t){return t.element.name===e.name}).length&&e},elements:function(){var e=this,r={};return t(this.currentForm).find("input, select, textarea").not(":submit, :reset, :image, [disabled]").not(this.settings.ignore).filter(function(){return!this.name&&e.settings.debug&&window.console&&console.error("%o has no name assigned",this),this.name in r||!e.objectLength(t(this).rules())?!1:(r[this.name]=!0,!0)})},clean:function(e){return t(e)[0]},errors:function(){var e=this.settings.errorClass.replace(" ",".");return t(this.settings.errorElement+"."+e,this.errorContext)},reset:function(){this.successList=[],this.errorList=[],this.errorMap={},this.toShow=t([]),this.toHide=t([]),this.currentElements=t([])},prepareForm:function(){this.reset(),this.toHide=this.errors().add(this.containers)},prepareElement:function(t){this.reset(),this.toHide=this.errorsFor(t)},elementValue:function(e){var r=t(e).attr("type"),n=t(e).val();return"radio"===r||"checkbox"===r?t("input[name='"+t(e).attr("name")+"']:checked").val():"string"==typeof n?n.replace(/\r/g,""):n},check:function(e){e=this.validationTargetFor(this.clean(e));var r,n=t(e).rules(),i=!1,a=this.elementValue(e);for(var s in n){var o={method:s,parameters:n[s]};try{if(r=t.validator.methods[s].call(this,a,e,o.parameters),"dependency-mismatch"===r){i=!0;continue}if(i=!1,"pending"===r)return void(this.toHide=this.toHide.not(this.errorsFor(e)));if(!r)return this.formatAndAdd(e,o),!1}catch(u){throw this.settings.debug&&window.console&&console.log("Exception occurred when checking element "+e.id+", check the '"+o.method+"' method.",u),u}}return i?void 0:(this.objectLength(n)&&this.successList.push(e),!0)},customDataMessage:function(e,r){return t(e).data("msg-"+r.toLowerCase())||e.attributes&&t(e).attr("data-msg-"+r.toLowerCase())},customMessage:function(t,e){var r=this.settings.messages[t];return r&&(r.constructor===String?r:r[e])},findDefined:function(){for(var t=0;t<arguments.length;t++)if(void 0!==arguments[t])return arguments[t];return void 0},defaultMessage:function(e,r){return this.findDefined(this.customMessage(e.name,r),this.customDataMessage(e,r),!this.settings.ignoreTitle&&e.title||void 0,t.validator.messages[r],"<strong>Warning: No message defined for "+e.name+"</strong>")},formatAndAdd:function(e,r){var n=this.defaultMessage(e,r.method),i=/\$?\{(\d+)\}/g;"function"==typeof n?n=n.call(this,r.parameters,e):i.test(n)&&(n=t.validator.format(n.replace(i,"{$1}"),r.parameters)),this.errorList.push({message:n,element:e}),this.errorMap[e.name]=n,this.submitted[e.name]=n},addWrapper:function(t){return this.settings.wrapper&&(t=t.add(t.parent(this.settings.wrapper))),t},defaultShowErrors:function(){var t,e;for(t=0;this.errorList[t];t++){var r=this.errorList[t];this.settings.highlight&&this.settings.highlight.call(this,r.element,this.settings.errorClass,this.settings.validClass),this.showLabel(r.element,r.message)}if(this.errorList.length&&(this.toShow=this.toShow.add(this.containers)),this.settings.success)for(t=0;this.successList[t];t++)this.showLabel(this.successList[t]);if(this.settings.unhighlight)for(t=0,e=this.validElements();e[t];t++)this.settings.unhighlight.call(this,e[t],this.settings.errorClass,this.settings.validClass);this.toHide=this.toHide.not(this.toShow),this.hideErrors(),this.addWrapper(this.toShow).show()},validElements:function(){return this.currentElements.not(this.invalidElements())},invalidElements:function(){return t(this.errorList).map(function(){return this.element})},showLabel:function(e,r){var n=this.errorsFor(e);n.length?(n.removeClass(this.settings.validClass).addClass(this.settings.errorClass),n.html(r)):(n=t("<"+this.settings.errorElement+">").attr("for",this.idOrName(e)).addClass(this.settings.errorClass).html(r||""),this.settings.wrapper&&(n=n.hide().show().wrap("<"+this.settings.wrapper+"/>").parent()),this.labelContainer.append(n).length||(this.settings.errorPlacement?this.settings.errorPlacement(n,t(e)):n.insertAfter(e))),!r&&this.settings.success&&(n.text(""),"string"==typeof this.settings.success?n.addClass(this.settings.success):this.settings.success(n,e)),this.toShow=this.toShow.add(n)},errorsFor:function(e){var r=this.idOrName(e);return this.errors().filter(function(){return t(this).attr("for")===r})},idOrName:function(t){return this.groups[t.name]||(this.checkable(t)?t.name:t.id||t.name)},validationTargetFor:function(t){return this.checkable(t)&&(t=this.findByName(t.name).not(this.settings.ignore)[0]),t},checkable:function(t){return/radio|checkbox/i.test(t.type)},findByName:function(e){return t(this.currentForm).find("[name='"+e+"']")},getLength:function(e,r){switch(r.nodeName.toLowerCase()){case"select":return t("option:selected",r).length;case"input":if(this.checkable(r))return this.findByName(r.name).filter(":checked").length}return e.length},depend:function(t,e){return this.dependTypes[typeof t]?this.dependTypes[typeof t](t,e):!0},dependTypes:{"boolean":function(t){return t},string:function(e,r){return!!t(e,r.form).length},"function":function(t,e){return t(e)}},optional:function(e){var r=this.elementValue(e);return!t.validator.methods.required.call(this,r,e)&&"dependency-mismatch"},startRequest:function(t){this.pending[t.name]||(this.pendingRequest++,this.pending[t.name]=!0)},stopRequest:function(e,r){this.pendingRequest--,this.pendingRequest<0&&(this.pendingRequest=0),delete this.pending[e.name],r&&0===this.pendingRequest&&this.formSubmitted&&this.form()?(t(this.currentForm).submit(),this.formSubmitted=!1):!r&&0===this.pendingRequest&&this.formSubmitted&&(t(this.currentForm).triggerHandler("invalid-form",[this]),this.formSubmitted=!1)},previousValue:function(e){return t.data(e,"previousValue")||t.data(e,"previousValue",{old:null,valid:!0,message:this.defaultMessage(e,"remote")})}},classRuleSettings:{required:{required:!0},email:{email:!0},url:{url:!0},date:{date:!0},dateISO:{dateISO:!0},number:{number:!0},digits:{digits:!0},creditcard:{creditcard:!0}},addClassRules:function(e,r){e.constructor===String?this.classRuleSettings[e]=r:t.extend(this.classRuleSettings,e)},classRules:function(e){var r={},n=t(e).attr("class");return n&&t.each(n.split(" "),function(){this in t.validator.classRuleSettings&&t.extend(r,t.validator.classRuleSettings[this])}),r},attributeRules:function(e){var r={},n=t(e),i=n[0].getAttribute("type");for(var a in t.validator.methods){var s;"required"===a?(s=n.get(0).getAttribute(a),""===s&&(s=!0),s=!!s):s=n.attr(a),/min|max/.test(a)&&(null===i||/number|range|text/.test(i))&&(s=Number(s)),s?r[a]=s:i===a&&"range"!==i&&(r[a]=!0)}return r.maxlength&&/-1|2147483647|524288/.test(r.maxlength)&&delete r.maxlength,r},dataRules:function(e){var r,n,i={},a=t(e);for(r in t.validator.methods)n=a.data("rule-"+r.toLowerCase()),void 0!==n&&(i[r]=n);return i},staticRules:function(e){var r={},n=t.data(e.form,"validator");return n.settings.rules&&(r=t.validator.normalizeRule(n.settings.rules[e.name])||{}),r},normalizeRules:function(e,r){return t.each(e,function(n,i){if(i===!1)return void delete e[n];if(i.param||i.depends){var a=!0;switch(typeof i.depends){case"string":a=!!t(i.depends,r.form).length;break;case"function":a=i.depends.call(r,r)}a?e[n]=void 0!==i.param?i.param:!0:delete e[n]}}),t.each(e,function(n,i){e[n]=t.isFunction(i)?i(r):i}),t.each(["minlength","maxlength"],function(){e[this]&&(e[this]=Number(e[this]))}),t.each(["rangelength","range"],function(){var r;e[this]&&(t.isArray(e[this])?e[this]=[Number(e[this][0]),Number(e[this][1])]:"string"==typeof e[this]&&(r=e[this].split(/[\s,]+/),e[this]=[Number(r[0]),Number(r[1])]))}),t.validator.autoCreateRanges&&(e.min&&e.max&&(e.range=[e.min,e.max],delete e.min,delete e.max),e.minlength&&e.maxlength&&(e.rangelength=[e.minlength,e.maxlength],delete e.minlength,delete e.maxlength)),e},normalizeRule:function(e){if("string"==typeof e){var r={};t.each(e.split(/\s/),function(){r[this]=!0}),e=r}return e},addMethod:function(e,r,n){t.validator.methods[e]=r,t.validator.messages[e]=void 0!==n?n:t.validator.messages[e],r.length<3&&t.validator.addClassRules(e,t.validator.normalizeRule(e))},methods:{required:function(e,r,n){if(!this.depend(n,r))return"dependency-mismatch";if("select"===r.nodeName.toLowerCase()){var i=t(r).val();return i&&i.length>0}return this.checkable(r)?this.getLength(e,r)>0:t.trim(e).length>0},email:function(t,e){return this.optional(e)||/^((([a-z]|\d|[!#\$%&'\*\+\-\/=\?\^_`{\|}~]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])+(\.([a-z]|\d|[!#\$%&'\*\+\-\/=\?\^_`{\|}~]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])+)*)|((\x22)((((\x20|\x09)*(\x0d\x0a))?(\x20|\x09)+)?(([\x01-\x08\x0b\x0c\x0e-\x1f\x7f]|\x21|[\x23-\x5b]|[\x5d-\x7e]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(\\([\x01-\x09\x0b\x0c\x0d-\x7f]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF]))))*(((\x20|\x09)*(\x0d\x0a))?(\x20|\x09)+)?(\x22)))@((([a-z]|\d|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(([a-z]|\d|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])*([a-z]|\d|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])))\.)+(([a-z]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(([a-z]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])*([a-z]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])))$/i.test(t)},url:function(t,e){return this.optional(e)||/^(https?|s?ftp):\/\/(((([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(%[\da-f]{2})|[!\$&'\(\)\*\+,;=]|:)*@)?(((\d|[1-9]\d|1\d\d|2[0-4]\d|25[0-5])\.(\d|[1-9]\d|1\d\d|2[0-4]\d|25[0-5])\.(\d|[1-9]\d|1\d\d|2[0-4]\d|25[0-5])\.(\d|[1-9]\d|1\d\d|2[0-4]\d|25[0-5]))|((([a-z]|\d|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(([a-z]|\d|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])*([a-z]|\d|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])))\.)+(([a-z]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(([a-z]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])*([a-z]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])))\.?)(:\d*)?)(\/((([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(%[\da-f]{2})|[!\$&'\(\)\*\+,;=]|:|@)+(\/(([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(%[\da-f]{2})|[!\$&'\(\)\*\+,;=]|:|@)*)*)?)?(\?((([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(%[\da-f]{2})|[!\$&'\(\)\*\+,;=]|:|@)|[\uE000-\uF8FF]|\/|\?)*)?(#((([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(%[\da-f]{2})|[!\$&'\(\)\*\+,;=]|:|@)|\/|\?)*)?$/i.test(t)},date:function(t,e){return this.optional(e)||!/Invalid|NaN/.test(new Date(t).toString())},dateISO:function(t,e){return this.optional(e)||/^\d{4}[\/\-]\d{1,2}[\/\-]\d{1,2}$/.test(t)},number:function(t,e){return this.optional(e)||/^-?(?:\d+|\d{1,3}(?:,\d{3})+)?(?:\.\d+)?$/.test(t)},digits:function(t,e){return this.optional(e)||/^\d+$/.test(t)},creditcard:function(t,e){if(this.optional(e))return"dependency-mismatch";if(/[^0-9 \-]+/.test(t))return!1;var r=0,n=0,i=!1;t=t.replace(/\D/g,"");for(var a=t.length-1;a>=0;a--){var s=t.charAt(a);n=parseInt(s,10),i&&(n*=2)>9&&(n-=9),r+=n,i=!i}return r%10===0},minlength:function(e,r,n){var i=t.isArray(e)?e.length:this.getLength(t.trim(e),r);return this.optional(r)||i>=n},maxlength:function(e,r,n){var i=t.isArray(e)?e.length:this.getLength(t.trim(e),r);return this.optional(r)||n>=i},rangelength:function(e,r,n){var i=t.isArray(e)?e.length:this.getLength(t.trim(e),r);return this.optional(r)||i>=n[0]&&i<=n[1]},min:function(t,e,r){return this.optional(e)||t>=r},max:function(t,e,r){return this.optional(e)||r>=t},range:function(t,e,r){return this.optional(e)||t>=r[0]&&t<=r[1]},equalTo:function(e,r,n){var i=t(n);return this.settings.onfocusout&&i.unbind(".validate-equalTo").bind("blur.validate-equalTo",function(){t(r).valid()}),e===i.val()},remote:function(e,r,n){if(this.optional(r))return"dependency-mismatch";var i=this.previousValue(r);if(this.settings.messages[r.name]||(this.settings.messages[r.name]={}),i.originalMessage=this.settings.messages[r.name].remote,this.settings.messages[r.name].remote=i.message,n="string"==typeof n&&{url:n}||n,i.old===e)return i.valid;i.old=e;var a=this;this.startRequest(r);var s={};return s[r.name]=e,t.ajax(t.extend(!0,{url:n,mode:"abort",port:"validate"+r.name,dataType:"json",data:s,success:function(n){a.settings.messages[r.name].remote=i.originalMessage;var s=n===!0||"true"===n;if(s){var o=a.formSubmitted;a.prepareElement(r),a.formSubmitted=o,a.successList.push(r),delete a.invalid[r.name],a.showErrors()}else{var u={},l=n||a.defaultMessage(r,"remote");u[r.name]=i.message=t.isFunction(l)?l(e):l,a.invalid[r.name]=!0,a.showErrors(u)}i.valid=s,a.stopRequest(r,s)}},n)),"pending"}}}),t.format=t.validator.format}(jQuery),!function(t){var e={};if(t.ajaxPrefilter)t.ajaxPrefilter(function(t,r,n){var i=t.port;"abort"===t.mode&&(e[i]&&e[i].abort(),e[i]=n)});else{var r=t.ajax;t.ajax=function(n){var i=("mode"in n?n:t.ajaxSettings).mode,a=("port"in n?n:t.ajaxSettings).port;return"abort"===i?(e[a]&&e[a].abort(),e[a]=r.apply(this,arguments),e[a]):r.apply(this,arguments)}}}(jQuery),!function(t){t.extend(t.fn,{validateDelegate:function(e,r,n){return this.bind(r,function(r){var i=t(r.target);return i.is(e)?n.apply(i,arguments):void 0})}})}(jQuery);var Query=function(t){"use strict";var e=function(t){var e,r,n,i,a=[];if("undefined"==typeof t||null===t||""===t)return a;for(0===t.indexOf("?")&&(t=t.substring(1)),r=t.toString().split(/[&;]/),e=0;e<r.length;e++)n=r[e],i=n.split("="),a.push([i[0],i[1]]);return a},r=e(t),n=function(){var t,e,n="";for(t=0;t<r.length;t++)e=r[t],n.length>0&&(n+="&"),n+=e.join("=");return n.length>0?"?"+n:n},i=function(t){return t=decodeURIComponent(t),t=t.replace("+"," ")},a=function(t){var e,n;for(n=0;n<r.length;n++)if(e=r[n],i(t)===i(e[0]))return e[1]},s=function(t){var e,n,a=[];for(e=0;e<r.length;e++)n=r[e],i(t)===i(n[0])&&a.push(n[1]);return a},o=function(t,e){var n,a,s,o,u=[];for(n=0;n<r.length;n++)a=r[n],s=i(a[0])===i(t),o=i(a[1])===i(e),(1===arguments.length&&!s||2===arguments.length&&!s&&!o)&&u.push(a);return r=u,this},u=function(t,e,n){return 3===arguments.length&&-1!==n?(n=Math.min(n,r.length),r.splice(n,0,[t,e])):arguments.length>0&&r.push([t,e]),this},l=function(t,e,n){var a,s,l=-1;if(3===arguments.length){for(a=0;a<r.length;a++)if(s=r[a],i(s[0])===i(t)&&decodeURIComponent(s[1])===i(n)){l=a;break}o(t,n).addParam(t,e,l)}else{for(a=0;a<r.length;a++)if(s=r[a],i(s[0])===i(t)){l=a;break}o(t),u(t,e,l)}return this};return{getParamValue:a,getParamValues:s,deleteParam:o,addParam:u,replaceParam:l,toString:n}},Uri=function(t){"use strict";var e=!1,r=function(t){for(var r={strict:/^(?:([^:\/?#]+):)?(?:\/\/((?:(([^:@]*)(?::([^:@]*))?)?@)?([^:\/?#]*)(?::(\d*))?))?((((?:[^?#\/]*\/)*)([^?#]*))(?:\?([^#]*))?(?:#(.*))?)/,loose:/^(?:(?![^:@]+:[^:@\/]*@)([^:\/?#.]+):)?(?:\/\/)?((?:(([^:@]*)(?::([^:@]*))?)?@)?([^:\/?#]*)(?::(\d*))?)(((\/(?:[^?#](?![^?#\/]*\.[^?#\/.]+(?:[?#]|$)))*\/?)?([^?#\/]*))(?:\?([^#]*))?(?:#(.*))?)/},n=["source","protocol","authority","userInfo","user","password","host","port","relative","path","directory","file","query","anchor"],i={name:"queryKey",parser:/(?:^|&)([^&=]*)=?([^&]*)/g},a=r[e?"strict":"loose"].exec(t),s={},o=14;o--;)s[n[o]]=a[o]||"";return s[i.name]={},s[n[12]].replace(i.parser,function(t,e,r){e&&(s[i.name][e]=r)}),s},n=r(t||""),i=new Query(n.query),a=function(t){return"undefined"!=typeof t&&(n.protocol=t),n.protocol},s=null,o=function(t){return"undefined"!=typeof t&&(s=t),null===s?-1!==n.source.indexOf("//"):s},u=function(t){return"undefined"!=typeof t&&(n.userInfo=t),n.userInfo},l=function(t){return"undefined"!=typeof t&&(n.host=t),n.host},d=function(t){return"undefined"!=typeof t&&(n.port=t),n.port},h=function(t){return"undefined"!=typeof t&&(n.path=t),n.path},c=function(t){return"undefined"!=typeof t&&(i=new Query(t)),i},m=function(t){return"undefined"!=typeof t&&(n.anchor=t),n.anchor},f=function(t){return a(t),this},p=function(t){return o(t),this},g=function(t){return u(t),this},v=function(t){return l(t),this},F=function(t){return d(t),this},y=function(t){return h(t),this},b=function(t){return c(t),this},C=function(t){return m(t),this},x=function(t){return c().getParamValue(t)},S=function(t){return c().getParamValues(t)},D=function(t,e){return 2===arguments.length?c().deleteParam(t,e):c().deleteParam(t),this},w=function(t,e,r){return 3===arguments.length?c().addParam(t,e,r):c().addParam(t,e),this},$=function(t,e,r){return 3===arguments.length?c().replaceParam(t,e,r):c().replaceParam(t,e),this},k=function(){var t="",e=function(t){return null!==t&&""!==t};return e(a())?(t+=a(),a().indexOf(":")!==a().length-1&&(t+=":"),t+="//"):o()&&e(l())&&(t+="//"),e(u())&&e(l())&&(t+=u(),u().indexOf("@")!==u().length-1&&(t+="@")),e(l())&&(t+=l(),e(d())&&(t+=":"+d())),e(h())?t+=h():e(l())&&(e(c().toString())||e(m()))&&(t+="/"),e(c().toString())&&(0!==c().toString().indexOf("?")&&(t+="?"),t+=c().toString()),e(m())&&(0!==m().indexOf("#")&&(t+="#"),t+=m()),t},E=function(){return new Uri(k())};return{protocol:a,hasAuthorityPrefix:o,userInfo:u,host:l,port:d,path:h,query:c,anchor:m,setProtocol:f,setHasAuthorityPrefix:p,setUserInfo:g,setHost:v,setPort:F,setPath:y,setQuery:b,setAnchor:C,getQueryParamValue:x,getQueryParamValues:S,deleteQueryParam:D,addQueryParam:w,replaceQueryParam:$,toString:k,clone:E}},jsUri=Uri;(function(){window.Spree=function(){function t(){}return t.ready=function(t){return jQuery(document).ready(t)},t.mountedAt=function(){return"/"},t.pathFor=function(t){var e;return e=""+window.location.protocol+"//"+window.location.hostname+(window.location.port?":"+window.location.port:""),""+e+this.mountedAt()+t},t.url=function(t,e){return void 0===t.path&&(t=new Uri(t)),e&&$.each(e,function(e,r){return t.addQueryParam(e,r)}),t},t.ajax=function(e,r){var n;return"string"==typeof e?$.ajax(t.url(e).toString(),r):(n=e.url,delete e.url,$.ajax(t.url(n).toString(),e))},t.routes={states_search:t.pathFor("api/states"),apply_coupon_code:function(e){return t.pathFor("api/orders/"+e+"/apply_coupon_code")}},t}()}).call(this),function(){var t,e,r,n,i,a,s,o,u,l,d,h,c,m,f,p,g,v,F,y=[].slice,b=[].indexOf||function(t){for(var e=0,r=this.length;r>e;e++)if(e in this&&this[e]===t)return e;return-1};t=jQuery,t.payment={},t.payment.fn={},t.fn.payment=function(){var e,r;return r=arguments[0],e=2<=arguments.length?y.call(arguments,1):[],t.payment.fn[r].apply(this,e)},i=/(\d{1,4})/g,n=[{type:"maestro",pattern:/^(5018|5020|5038|6304|6759|676[1-3])/,format:i,length:[12,13,14,15,16,17,18,19],cvcLength:[3],luhn:!0},{type:"dinersclub",pattern:/^(36|38|30[0-5])/,format:i,length:[14],cvcLength:[3],luhn:!0},{type:"laser",pattern:/^(6706|6771|6709)/,format:i,length:[16,17,18,19],cvcLength:[3],luhn:!0},{type:"jcb",pattern:/^35/,format:i,length:[16],cvcLength:[3],luhn:!0},{type:"unionpay",pattern:/^62/,format:i,length:[16,17,18,19],cvcLength:[3],luhn:!1},{type:"discover",pattern:/^(6011|65|64[4-9]|622)/,format:i,length:[16],cvcLength:[3],luhn:!0},{type:"mastercard",pattern:/^5[1-5]/,format:i,length:[16],cvcLength:[3],luhn:!0},{type:"amex",pattern:/^3[47]/,format:/(\d{1,4})(\d{1,6})?(\d{1,5})?/,length:[15],cvcLength:[3,4],luhn:!0},{type:"visa",pattern:/^4/,format:i,length:[13,14,15,16],cvcLength:[3],luhn:!0}],e=function(t){var e,r,i;for(t=(t+"").replace(/\D/g,""),r=0,i=n.length;i>r;r++)if(e=n[r],e.pattern.test(t))return e},r=function(t){var e,r,i;for(r=0,i=n.length;i>r;r++)if(e=n[r],e.type===t)return e},c=function(t){var e,r,n,i,a,s;for(n=!0,i=0,r=(t+"").split("").reverse(),a=0,s=r.length;s>a;a++)e=r[a],e=parseInt(e,10),(n=!n)&&(e*=2),e>9&&(e-=9),i+=e;return i%10===0},h=function(t){var e;return null!=t.prop("selectionStart")&&t.prop("selectionStart")!==t.prop("selectionEnd")?!0:("undefined"!=typeof document&&null!==document&&null!=(e=document.selection)&&"function"==typeof e.createRange?e.createRange().text:void 0)?!0:!1},m=function(e){return setTimeout(function(){var r,n;return r=t(e.currentTarget),n=r.val(),n=t.payment.formatCardNumber(n),r.val(n)})},o=function(r){var n,i,a,s,o,u,l;return a=String.fromCharCode(r.which),!/^\d+$/.test(a)||(n=t(r.currentTarget),l=n.val(),i=e(l+a),s=(l.replace(/\D/g,"")+a).length,u=16,i&&(u=i.length[i.length.length-1]),s>=u||null!=n.prop("selectionStart")&&n.prop("selectionStart")!==l.length)?void 0:(o=i&&"amex"===i.type?/^(\d{4}|\d{4}\s\d{6})$/:/(?:^|\s)(\d{4})$/,o.test(l)?(r.preventDefault(),n.val(l+" "+a)):o.test(l+a)?(r.preventDefault(),n.val(l+a+" ")):void 0)},a=function(e){var r,n;return r=t(e.currentTarget),n=r.val(),e.meta||8!==e.which||null!=r.prop("selectionStart")&&r.prop("selectionStart")!==n.length?void 0:/\d\s$/.test(n)?(e.preventDefault(),r.val(n.replace(/\d\s$/,""))):/\s\d?$/.test(n)?(e.preventDefault(),r.val(n.replace(/\s\d?$/,""))):void 0},u=function(e){var r,n,i;return n=String.fromCharCode(e.which),/^\d+$/.test(n)?(r=t(e.currentTarget),i=r.val()+n,/^\d$/.test(i)&&"0"!==i&&"1"!==i?(e.preventDefault(),r.val("0"+i+" / ")):/^\d\d$/.test(i)?(e.preventDefault(),r.val(""+i+" / ")):void 0):void 0},l=function(e){var r,n,i;return n=String.fromCharCode(e.which),/^\d+$/.test(n)?(r=t(e.currentTarget),i=r.val(),/^\d\d$/.test(i)?r.val(""+i+" / "):void 0):void 0},d=function(e){var r,n,i;return n=String.fromCharCode(e.which),"/"===n?(r=t(e.currentTarget),i=r.val(),/^\d$/.test(i)&&"0"!==i?r.val("0"+i+" / "):void 0):void 0},s=function(e){var r,n;if(!e.meta&&(r=t(e.currentTarget),n=r.val(),8===e.which&&(null==r.prop("selectionStart")||r.prop("selectionStart")===n.length)))return/\d(\s|\/)+$/.test(n)?(e.preventDefault(),r.val(n.replace(/\d(\s|\/)*$/,""))):/\s\/\s?\d?$/.test(n)?(e.preventDefault(),r.val(n.replace(/\s\/\s?\d?$/,""))):void 0},v=function(t){var e;return t.metaKey||t.ctrlKey?!0:32===t.which?!1:0===t.which?!0:t.which<33?!0:(e=String.fromCharCode(t.which),!!/[\d\s]/.test(e))},p=function(r){var n,i,a,s;return n=t(r.currentTarget),a=String.fromCharCode(r.which),/^\d+$/.test(a)&&!h(n)?(s=(n.val()+a).replace(/\D/g,""),i=e(s),i?s.length<=i.length[i.length.length-1]:s.length<=16):void 0},g=function(e){var r,n,i;return r=t(e.currentTarget),n=String.fromCharCode(e.which),/^\d+$/.test(n)&&!h(r)?(i=r.val()+n,i=i.replace(/\D/g,""),i.length>6?!1:void 0):void 0},f=function(e){var r,n,i;return r=t(e.currentTarget),n=String.fromCharCode(e.which),/^\d+$/.test(n)?(i=r.val()+n,i.length<=4):void 0},F=function(e){var r,i,a,s,o;return r=t(e.currentTarget),o=r.val(),s=t.payment.cardType(o)||"unknown",r.hasClass(s)?void 0:(i=function(){var t,e,r;for(r=[],t=0,e=n.length;e>t;t++)a=n[t],r.push(a.type);return r}(),r.removeClass("unknown"),r.removeClass(i.join(" ")),r.addClass(s),r.toggleClass("identified","unknown"!==s),r.trigger("payment.cardType",s))},t.payment.fn.formatCardCVC=function(){return this.payment("restrictNumeric"),this.on("keypress",f),this},t.payment.fn.formatCardExpiry=function(){return this.payment("restrictNumeric"),this.on("keypress",g),this.on("keypress",u),this.on("keypress",d),this.on("keypress",l),this.on("keydown",s),this},t.payment.fn.formatCardNumber=function(){return this.payment("restrictNumeric"),this.on("keypress",p),this.on("keypress",o),this.on("keydown",a),this.on("keyup",F),this.on("paste",m),this},t.payment.fn.restrictNumeric=function(){return this.on("keypress",v),this},t.payment.fn.cardExpiryVal=function(){return t.payment.cardExpiryVal(t(this).val())},t.payment.cardExpiryVal=function(t){var e,r,n,i;return t=t.replace(/\s/g,""),i=t.split("/",2),e=i[0],n=i[1],2===(null!=n?n.length:void 0)&&/^\d+$/.test(n)&&(r=(new Date).getFullYear(),r=r.toString().slice(0,2),n=r+n),e=parseInt(e,10),n=parseInt(n,10),{month:e,year:n}},t.payment.validateCardNumber=function(t){var r,n;return t=(t+"").replace(/\s+|-/g,""),/^\d+$/.test(t)?(r=e(t),r?(n=t.length,b.call(r.length,n)>=0&&(r.luhn===!1||c(t))):!1):!1},t.payment.validateCardExpiry=function(e,r){var n,i,a,s;return"object"==typeof e&&"month"in e&&(s=e,e=s.month,r=s.year),e&&r?(e=t.trim(e),r=t.trim(r),/^\d+$/.test(e)&&/^\d+$/.test(r)&&parseInt(e,10)<=12?(2===r.length&&(a=(new Date).getFullYear(),a=a.toString().slice(0,2),r=a+r),i=new Date(r,e),n=new Date,i.setMonth(i.getMonth()-1),i.setMonth(i.getMonth()+1,1),i>n):!1):!1},t.payment.validateCardCVC=function(e,n){var i,a;return e=t.trim(e),/^\d+$/.test(e)?n?(i=e.length,b.call(null!=(a=r(n))?a.cvcLength:void 0,i)>=0):e.length>=3&&e.length<=4:!1},t.payment.cardType=function(t){var r;return t?(null!=(r=e(t))?r.type:void 0)||null:null},t.payment.formatCardNumber=function(t){var r,n,i,a;return(r=e(t))?(i=r.length[r.length.length-1],t=t.replace(/\D/g,""),t=t.slice(0,+i+1||9e9),r.format.global?null!=(a=t.match(r.format))?a.join(" "):void 0:(n=r.format.exec(t),null!=n&&n.shift(),null!=n?n.join(" "):void 0)):t}}.call(this),function(){Spree.disableSaveOnClick=function(){return $("form.edit_order").submit(function(){return $(this).find(":submit, :image").attr("disabled",!0).removeClass("primary").addClass("disabled")})},Spree.ready(function(){return Spree.Checkout={}})}.call(this),function(){Spree.ready(function(t){return Spree.onAddress=function(){var e,r,n;return t("#checkout_form_address").is("*")?(t("#checkout_form_address").validate(),e=function(e){return t("#"+e+"country select").val()
},Spree.updateState=function(r){var n;return n=e(r),null!=n?null==Spree.Checkout[n]?t.get(Spree.routes.states_search,{country_id:n},function(t){return Spree.Checkout[n]={states:t.states,states_required:t.states_required},Spree.fillStates(Spree.Checkout[n],r)}):Spree.fillStates(Spree.Checkout[n],r):void 0},Spree.fillStates=function(e,r){var n,i,a,s,o,u,l,d;return l=e.states_required,u=e.states,a=t("#"+r+"state"),s=a.find("select"),i=a.find("input"),o=a.find('[id$="state-required"]'),u.length>0?(n=parseInt(s.val()),s.html(""),d=[{name:"",id:""}].concat(u),t.each(d,function(e,r){var i;return i=t(document.createElement("option")).attr("value",r.id).html(r.name),n===r.id&&i.prop("selected",!0),s.append(i)}),s.prop("disabled",!1).show(),i.hide().prop("disabled",!0),a.show(),o.show(),l&&s.addClass("required"),s.removeClass("hidden"),i.removeClass("required")):(s.hide().prop("disabled",!0),i.show(),l?(o.show(),i.addClass("required")):(i.val(""),o.hide(),i.removeClass("required")),a.toggle(!!l),i.prop("disabled",!l),i.removeClass("hidden"),s.removeClass("required"))},t("#bcountry select").change(function(){return Spree.updateState("b")}),t("#scountry select").change(function(){return Spree.updateState("s")}),Spree.updateState("b"),r=t("input#order_use_billing"),r.change(function(){return n(r)}),(n=function(e){return e.is(":checked")?(t("#shipping .inner").hide(),t("#shipping .inner input, #shipping .inner select").prop("disabled",!0)):(t("#shipping .inner").show(),t("#shipping .inner input, #shipping .inner select").prop("disabled",!1),Spree.updateState("s"))})(r)):void 0},Spree.onAddress()})}.call(this),function(){Spree.ready(function(t){return Spree.onPayment=function(){return t("#checkout_form_payment").is("*")?(t("#existing_cards").is("*")&&(t("#payment-method-fields").hide(),t("#payment-methods").hide(),t("#use_existing_card_yes").click(function(){return t("#payment-method-fields").hide(),t("#payment-methods").hide(),t(".existing-cc-radio").prop("disabled",!1)}),t("#use_existing_card_no").click(function(){return t("#payment-method-fields").show(),t("#payment-methods").show(),t(".existing-cc-radio").prop("disabled",!0)})),t(".cardNumber").payment("formatCardNumber"),t(".cardExpiry").payment("formatCardExpiry"),t(".cardCode").payment("formatCardCVC"),t(".cardNumber").change(function(){return t(this).parent().siblings(".ccType").val(t.payment.cardType(this.value))}),t('input[type="radio"][name="order[payments_attributes][][payment_method_id]"]').click(function(){return t("#payment-methods li").hide(),this.checked?t("#payment_method_"+this.value).show():void 0}),t(document).on("click","#cvv_link",function(e){var r,n;return r="cvv_info",n="left=20,top=20,width=500,height=500,toolbar=0,resizable=0,scrollbars=1",window.open(t(this).attr("href"),r,n),e.preventDefault()}),t('input[type="radio"]:checked').click(),t("#checkout_form_payment").submit(function(){var e,r,n,i;return r=t("#order_coupon_code"),e=t.trim(r.val()),""!==e?(0===t("#coupon_status").length?(n=t("<div id='coupon_status'></div>"),r.parent().append(n)):n=t("#coupon_status"),i=Spree.url(Spree.routes.apply_coupon_code(Spree.current_order_id),{order_token:Spree.current_order_token,coupon_code:e}),n.removeClass(),t.ajax({async:!1,method:"PUT",url:i,success:function(){return r.val(""),n.addClass("success").html("Coupon code applied successfully."),!0},error:function(e){var r;return r=JSON.parse(e.responseText),n.addClass("error").html(r.error),t(".continue").attr("disabled",!1),!1}})):void 0})):void 0},Spree.onPayment()})}.call(this),function(){$(function(){var t,e;return Spree.addImageHandlers=function(){var t;return t=$("#product-images ul.thumbnails"),$("#main-image").data("selectedThumb",$("#main-image img").attr("src")),t.find("li").eq(0).addClass("selected"),t.find("a").on("click",function(e){return $("#main-image").data("selectedThumb",$(e.currentTarget).attr("href")),$("#main-image").data("selectedThumbId",$(e.currentTarget).parent().attr("id")),t.find("li").removeClass("selected"),$(e.currentTarget).parent("li").addClass("selected"),!1}),t.find("li").on("mouseenter",function(t){return $("#main-image img").attr("src",$(t.currentTarget).find("a").attr("href"))}),t.find("li").on("mouseleave",function(){return $("#main-image img").attr("src",$("#main-image").data("selectedThumb"))})},Spree.showVariantImages=function(t){var e,r,n;return $("li.vtmb").hide(),$("li.tmb-"+t).show(),e=$("#"+$("#main-image").data("selectedThumbId")),e.hasClass("vtmb-"+t)?void 0:(n=$($("#product-images ul.thumbnails li:visible.vtmb").eq(0)),n.length>0||(n=$($("#product-images ul.thumbnails li:visible").eq(0))),r=n.find("a").attr("href"),$("#product-images ul.thumbnails li").removeClass("selected"),n.addClass("selected"),$("#main-image img").attr("src",r),$("#main-image").data("selectedThumb",r),$("#main-image").data("selectedThumbId",n.attr("id")))},Spree.updateVariantPrice=function(t){var e;return e=t.data("price"),e?$(".price.selling").text(e):void 0},t=$('#product-variants input[type="radio"]'),t.length>0&&(e=$('#product-variants input[type="radio"][checked="checked"]'),Spree.showVariantImages(e.attr("value")),Spree.updateVariantPrice(e)),Spree.addImageHandlers(),t.click(function(){return Spree.showVariantImages(this.value),Spree.updateVariantPrice($(this))})})}.call(this),function(){Spree.ready(function(t){return t("form#update-cart").is("*")&&t("form#update-cart a.delete").show().one("click",function(){return t(this).parents(".line-item").first().find("input.line_item_quantity").val(0),t(this).parents("form").first().submit(),!1}),t("form#update-cart").submit(function(){return t("form#update-cart #update-button").attr("disabled",!0)})}),Spree.fetch_cart=function(){return $.ajax({url:Spree.pathFor("cart_link"),success:function(t){return $("#link-to-cart").html(t)}})}}.call(this);